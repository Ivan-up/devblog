<?php//// Контроллер обработки виджетов.//class C_Widget extends C_Controller{	private $content;	private $params;		//	// Конструктор.	//	public function __construct($params)	{		$this->content = '';		$this->params = $params;	}		public function before()	{		$this->template_name = M_Templates::Instance()->getCurrentTemplate(); 		$this->templateDir = BASE_URL . TEMPLATE_DIR . $this->template_name;	}		public function Go($action, $controller) {		$this->before();		$this->$action();		return $this->content;	}		public function render()	{		echo $this->content;	}		public function __call($name, $arguments)	{		$this->content = '';	}		//	// Виджет "lightbox".	// <widget title="Сборник шпаргалок" widget-type="lightbox">[[--widget/gallery/1--]]</widget>	//	public function action_gallery()	{		$id_gallery = isset($this->params[2]) ? (int)$this->params[2] : 0;		if ($id_gallery < 1 || !($images = M_Gallery::Instance()->get_images($id_gallery)))		{			$this->content = '';		}		else		{			// Получение пути к шаблону 																$templateName = $this->getTemplate('components/widgets/v_gallery.php');						// Формирование контента страницы 			$this->content = $this->Template($templateName, array('images' => $images));		}	}		//	// Виджет "slider" 	// <widget title="Сборник шпаргалок" widget-type="slider">[[--widget/gallery/1--]]</widget>	//	public function action_slider()	{		$id_gallery = isset($this->params[2]) ? (int)$this->params[2] : 0;		if ($id_gallery < 1 || !($images = M_Gallery::Instance()->get_images($id_gallery)))		{			$this->content = '';		}		else		{			// Получение пути к шаблону 																$templateName = $this->getTemplate('components/widgets/v_slider.php');						// Формирование контента страницы 			$this->content = $this->Template($templateName, array('images' => $images));		}	}		//	// Виджет "diafilm" 	// <widget title="Сборник шпаргалок" widget-type="diafilm">[[--widget/diafilm/1--]]</widget>	//	public function action_diafilm()	{		$id_gallery = isset($this->params[2]) ? (int)$this->params[2] : 0;		if ($id_gallery < 1 || !($images = M_Gallery::Instance()->get_images($id_gallery)))		{			$this->content = '';		}		else		{			// Получение пути к шаблону 																$templateName = $this->getTemplate('components/widgets/v_diafilm.php');						// Формирование контента страницы 			$this->content = $this->Template($templateName, array('images' => $images));		}	}		//	// Виджет "video"	// <widget title="Зверополис" widget-type="video">[[--widget/video/13--]]</widget>	//	public function action_video()	{		$id_video = isset($this->params[2]) ? (int)$this->params[2] : 0;		if ($id_video < 1 || !($video = M_MediaFiles::Instance()->get($id_video)))		{			$this->content = '';		}		else		{			// Получение пути к шаблону 																$templateName = $this->getTemplate('components/widgets/v_video.php');						// Формирование контента страницы 			$this->content = $this->Template($templateName, array('video' => $video));		}	}		//	// Виджет "audio"	// <widget title="Rammstein - Nebel" widget-type="audio">[[--widget/audio/18--]]</widget>	//	public function action_audio()	{		$id_audio = isset($this->params[2]) ? (int)$this->params[2] : 0;		if ($id_audio < 1 || !($audio = M_MediaFiles::Instance()->get($id_audio)))		{			$this->content = '';		}		else		{			// Получение пути к шаблону 																$templateName = $this->getTemplate('components/widgets/v_audio.php');						// Формирование контента страницы 			$this->content = $this->Template($templateName, array('audio' => $audio));		}	}		//	// Виджет "poll"	// <widget title="Какой серверный язык вы предпочитаете" widget-type="poll">[[--widget/poll/1--]]</widget>	//	public function action_poll()	{		$pid = isset($this->params[2]) ? (int)$this->params[2] : 0;		// Получение пути к шаблону 															$templateName = $this->getTemplate('components/widgets/v_poll.php');				$poll = new C_Poll();		$this->content = $poll->get_filled_template_poll($pid, $templateName);	  unset($poll);	}}